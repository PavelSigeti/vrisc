import{A as C}from"./AppHeader.ce1caf4c.js";import{A as L}from"./logo.eb15b55a.js";import{t as M}from"./time.a44078dd.js";import{_ as f,u as E,r as p,x as y,G as B,a as d,o as s,c as r,e as u,f as v,b as n,d as x,w as S,g as k,Q as m,V as A,P as b,F as h}from"./app.99542f7f.js";const H={name:"AppUserStage",components:{AppLoader:L},props:["stage"],setup(a){const t=()=>{const i=new Date().toLocaleString("ru-RU",{timeZone:"Europe/Moscow"}).split(",");_.value=`${i[0]} ${i[1]}`},l=E(),e=p(a.stage),g=p(!1),_=p();y(()=>{t()});const c=setInterval(t,1e3);return B(()=>{clearInterval(c)}),{stage:e,loading:g,time:M,toggleReg:async()=>{g.value=!0;try{e.value.users_exists?(await axios.post(`/api/stage/${e.value.id}/cancel`),e.value.users_exists=!1,l.dispatch("notification/displayMessage",{value:"\u0412\u044B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0442\u043A\u0430\u0437\u0430\u043B\u0438\u0441\u044C \u043E\u0442 \u0443\u0447\u0430\u0441\u0442\u0438\u0435 \u0432 \u0440\u0435\u0433\u0430\u0442\u0435",type:"primary"})):(await axios.post(`/api/stage/${e.value.id}/accept`),e.value.users_exists=!0,l.dispatch("notification/displayMessage",{value:"\u0412\u044B \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u044B \u043D\u0430 \u0440\u0435\u0433\u0430\u0442\u0443",type:"primary"}))}catch(i){console.log(i.message),l.dispatch("notification/displayMessage",{value:i.response.data.message,type:"error"})}g.value=!1},now:_}}},V={class:"user-stage"},N={class:"user-stage__header"},T={class:"user-stage__tournament"},D={key:0,class:"user-stage__participant"},I=["innerHTML"],F={class:"user-stage__date"},z={key:2,class:"user-stage__info"},G={key:3,class:"user-stage__info"},P={key:5,class:"user-stage__info"},Q={key:6,class:"user-stage__info"};function Z(a,t,l,e,g,_){const c=d("AppLoader"),o=d("router-link");return s(),r("div",V,[e.loading?(s(),u(c,{key:0})):v("",!0),n("div",N,[x(o,{to:`/dashboard/stage/${e.stage.id}`,class:"user-stage__title"},{default:S(()=>[k(m(e.stage.title),1)]),_:1},8,["to"]),n("div",T,m(e.stage.tournament),1),e.stage.users_exists?(s(),r("div",D,"\u0412\u044B \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u0435\u0442\u0435")):v("",!0)]),e.stage.excerpt?(s(),r("div",{key:1,class:"user-stage__excerpt content",innerHTML:e.stage.excerpt},null,8,I)):v("",!0),n("div",F,[n("span",null,"\u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+m(e.time(e.stage.register_start)),1),n("span",null,"\u041E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438: "+m(e.time(e.stage.register_end)),1),n("span",null,"\u041D\u0430\u0447\u0430\u043B\u043E \u0433\u043E\u043D\u043E\u043A: "+m(e.time(e.stage.race_start)),1)]),e.time(e.stage.register_start)>e.now?(s(),r("div",z," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043D\u0435 \u043D\u0430\u0447\u0430\u043B\u0430\u0441\u044C ")):e.time(e.stage.race_start)<e.now&&e.stage.status!=="finished"?(s(),r("div",G," \u0420\u0435\u0433\u0430\u0442\u0430 \u043F\u0440\u043E\u0445\u043E\u0434\u0438\u0442 ")):e.stage.status==="active"&&e.time(e.stage.register_end)>e.now?(s(),r("div",{key:4,class:A(["btn","btn-settings-280",{"btn-default":!e.stage.users_exists},{"btn-border":e.stage.users_exists}]),onClick:t[0]||(t[0]=(...i)=>e.toggleReg&&e.toggleReg(...i))},m(e.stage.users_exists?"\u041E\u0442\u043A\u0430\u0437\u0430\u0442\u044C\u0441\u044F \u043E\u0442 \u0443\u0447\u0430\u0441\u0442\u0438\u044F":"\u041F\u0440\u0438\u043D\u044F\u0442\u044C \u0443\u0447\u0430\u0441\u0442\u0438\u0435"),3)):e.stage.status==="finished"?(s(),r("div",P," \u0420\u0435\u0433\u0430\u0442\u0430 \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0430\u0441\u044C ")):(s(),r("div",Q," \u041E\u0436\u0438\u0434\u0430\u0439\u0442\u0435 ")),x(o,{to:`/dashboard/stage/${e.stage.id}`,class:"btn btn-border btn-settings-280 mt10"},{default:S(()=>[k("\u041F\u043E\u0434\u0440\u043E\u0431\u043D\u0435\u0435")]),_:1},8,["to"])])}const w=f(H,[["render",Z]]),j={name:"AppActualStage",components:{AppUserStage:w},setup(){const a=p();return y(async()=>{try{const t=await axios.get("/api/stage/actual");a.value=t.data}catch(t){console.log(t.message)}}),{stages:a}}};function q(a,t,l,e,g,_){const c=d("AppUserStage");return s(!0),r(h,null,b(e.stages,o=>(s(),u(c,{key:o.id,stage:o},null,8,["stage"]))),128)}const J=f(j,[["render",q]]),K={name:"AppRegisteredStage",components:{AppUserStage:w},setup(){const a=p();return y(async()=>{try{const t=await axios.get("/api/stage/registered-stage");a.value=t.data}catch(t){console.log(t.message)}}),{stages:a}}};function O(a,t,l,e,g,_){const c=d("AppUserStage");return s(!0),r(h,null,b(e.stages,o=>(s(),u(c,{key:o.id,stage:o},null,8,["stage"]))),128)}const W=f(K,[["render",O]]),X={name:"AppEndedStage",components:{AppUserStage:w},setup(){const a=p();return y(async()=>{try{const t=await axios.get("/api/stage/ended");a.value=t.data}catch(t){console.log(t.message)}}),{stages:a}}};function Y(a,t,l,e,g,_){const c=d("AppUserStage");return s(!0),r(h,null,b(e.stages,o=>(s(),u(c,{key:o.id,stage:o},null,8,["stage"]))),128)}const $=f(X,[["render",Y]]),ee={name:"StageUser",components:{AppHeader:C,AppActualStage:J,AppRegisteredStage:W,AppEndedStage:$},setup(){return{section:p("actual")}}},te={class:"container-fluid g-0"},se={class:"row"},ae={class:"col-12"},ne={class:"tabs"},oe={class:"col-12"};function re(a,t,l,e,g,_){const c=d("AppHeader"),o=d("AppActualStage"),i=d("AppRegisteredStage"),R=d("AppEndedStage");return s(),r(h,null,[x(c,null,{default:S(()=>[k("\u0420\u0435\u0433\u0430\u0442\u044B")]),_:1}),n("main",null,[n("div",te,[n("div",se,[n("div",ae,[n("div",ne,[n("div",{class:A(["tab-item",{"tab-item__active":e.section==="actual"}]),onClick:t[0]||(t[0]=U=>e.section="actual")},"\u0410\u043A\u0442\u0443\u0430\u043B\u044C\u043D\u044B\u0435 \u0440\u0435\u0433\u0430\u0442\u044B",2),n("div",{class:A(["tab-item",{"tab-item__active":e.section==="registered"}]),onClick:t[1]||(t[1]=U=>e.section="registered")},"\u041C\u043E\u0438 \u0440\u0435\u0433\u0430\u0442\u044B",2),n("div",{class:A(["tab-item",{"tab-item__active":e.section==="ended"}]),onClick:t[2]||(t[2]=U=>e.section="ended")},"\u041F\u0440\u043E\u0448\u0435\u0434\u0448\u0438\u0435 \u0440\u0435\u0433\u0430\u0442\u044B",2)])]),n("div",oe,[e.section==="actual"?(s(),u(o,{key:0})):v("",!0),e.section==="registered"?(s(),u(i,{key:1})):v("",!0),e.section==="ended"?(s(),u(R,{key:2})):v("",!0)])])])])],64)}const ge=f(ee,[["render",re]]);export{ge as default};
