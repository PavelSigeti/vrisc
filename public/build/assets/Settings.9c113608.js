import{_ as x,u as y,r as _,x as V,j as p,a as o,o as b,c as w,d as f,w as k,b as e,e as A,f as S,g as i,Q as g,U as F,F as C,m as E}from"./app.a72d9fff.js";import{A as M,F as B,E as N,c as H,b as L,u as R}from"./logo.04de8c7a.js";import{C as U}from"./vue-select.b2b70ab6.js";import{A as j}from"./AppHeader.537e466b.js";const q={name:"Settings",components:{AppHeader:j,AppLoader:M,vSelect:U,Field:B,ErrorMessage:N},setup(){const r=y(),t=r.getters["auth/user"],c=t,a=_(!1),h=_(t.nickname),l=_(),d=H({nickname:L().required("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0438\u043A\u043D\u0435\u0439\u043C").min(2,"\u041E\u0442 2-\u0445 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432").max(32,"\u0414\u043E 32-\u0445 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432")}),{values:v,handleSubmit:m}=R({validationSchema:d});V(async()=>{a.value=!0;try{const s=await p.get("/api/user-settings");t.email=s.data.email,t.university=s.data.university;const n=await p.get("/api/universities");l.value=n.data}catch(s){console.log(s.message)}a.value=!1});const u=m(async s=>{a.value=!0,s.university_id=s.university_id?s.university_id.code:null;try{await p.patch("/api/user/update",s),c.nickname=s.nickname,r.commit("auth/setUser",c)}catch(n){console.log(n.message)}a.value=!1});return{loading:a,user:t,nickname:h,universities:l,submit:u}}},D={class:"container-fluid g-0"},P={class:"row"},Q={class:"col-lg-6 col-xl-5 col-xxl-4"},T={class:"dashboard-item"},z=e("h3",null,"\u0414\u0430\u043D\u043D\u044B\u0435 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F",-1),G={class:"user-account__data"},I={class:"b500"},J={class:"b500"},K={class:"b500"},O={class:"form-control"},W=e("label",{for:"nickname"},"\u041D\u0438\u043A\u043D\u0435\u0439\u043C \u0432 Virtual Regatta",-1),X=e("button",{class:"btn btn-default btn-full-width"},"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",-1);function Y(r,t,c,a,h,l){const d=o("AppHeader"),v=o("AppLoader"),m=o("Field"),u=o("ErrorMessage");return b(),w(C,null,[f(d,null,{default:k(()=>[i("\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430")]),_:1}),e("main",null,[e("div",D,[e("div",P,[e("div",Q,[e("div",T,[a.loading?(b(),A(v,{key:0})):S("",!0),z,e("div",G,[e("p",null,[i("\u0418\u043C\u044F: "),e("span",I,g(a.user.name),1)]),e("p",null,[i("\u0424\u0430\u043C\u0438\u043B\u0438\u044F: "),e("span",J,g(a.user.surname),1)]),e("p",null,[i("E-mail: "),e("span",K,g(a.user.email),1)])]),e("form",{onSubmit:t[1]||(t[1]=F((...s)=>a.submit&&a.submit(...s),["prevent"]))},[e("div",O,[W,f(m,{modelValue:a.nickname,"onUpdate:modelValue":t[0]||(t[0]=s=>a.nickname=s),name:"nickname"},{default:k(({field:s,errors:n})=>[e("input",E(s,{type:"text",class:["form-input",{invalid:!!n.length}],placeholder:"\u041D\u0438\u043A\u043D\u0435\u0439\u043C \u0432 Virtual Regatta"}),null,16)]),_:1},8,["modelValue"]),f(u,{class:"alert",name:"nickname"})]),X],32)])])])])])],64)}const ae=x(q,[["render",Y]]);export{ae as default};
